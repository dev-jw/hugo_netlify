---
title: "iOS性能优化-启动优化"
date: 2020-11-18T20:00:54+08:00
draft: true
tags: ["iOS"]
url:  "start-optimization"
---

启动优化

### Main函数之前(pre-main)

- dylib loading time：动态库加载耗时，尽可能使用系统动态库，保证自定义动态库总数不要超过 6 个，超过 6 个以上，考虑合并动态库
- rebase/bingding time：偏移修正、符号绑定耗时
  - 偏移修正：二进制文件的方法、函数调用的内存地址
    - 运行时， ASLR（安全机制）会给App 分配一个随机值，插入到二进制的头，即 真正的内存地址 = 二进制文件的地址 + ASLR 分配的随机值 
  - 符号绑定：Mach-O文件中，创建一个符号表示 NSLog，指向了一个随机的值，在运行时，会将 NSLog 的真正地址绑定到这个符号，是在内存中进行的操作
- ObjC setup time：OC的注册类，减少 OC 类
- initializer time：load方法、C++构造方法的耗时，尽可能的减少 load 方法，即在 load 方法执行的非必须的方法，延时执行

### Main函数之后——首屏渲染

- 减少启动后的流程，尽快的延迟，删除不用的类与业务
- 加载的功能，开启多线程去处理
- 启动的页面，最好不要用 xib



### 二进制重排

物理内存

- 内存不够
- 内存数据安全问题

虚拟内存

缺页异常——PageFault



优化思路：

将所有启动时刻需要调用的方法，排列在一起

